<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="./iconfont/iconfont.css" />
    <link rel="stylesheet" href="./style/navMeun.css" />
    <!-- <link rel="stylesheet" href="./style/bootstrap.min.css" /> -->
    <link rel="stylesheet" href="./style/uikit.css" />
    <title>数据模型</title>
    <script src="./yao.js"></script>
    <script src="./jquery.js"></script>
  </head>

  <body>
    <div id="nav_meun_wrap" class="nav_meun_wrap"></div>

    <div
      id="table_div"
      class="table-responsive"
      style="width: 80%; margin-left: 300px; margin-top: 100px"
    >
      <table class="uk-table uk-table-striped">
        <thead>
          <tr>
            <th>字段名称</th>
            <th>字段类型</th>
            <th>中文名称</th>
            <th>备注</th>
            <th>是否为空</th>
            <th>Table heading</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- 菜单数据 -->
    <script>
      /**
       * <li><div class="sub_menu"><i class="iconfont menu_icon icon-iconfontcomputer"></i><span class="menu_title">电影</span><i class="iconfont arrow_icon icon-jiantou"></i>
       * </div><ul class="hide_collapse"><a href="/movie/action">
       * <li><i class="iconfont menu_icon "></i><span class="menu_title">动作片</span></li>
       * </a><a href="/movie/comedy">
       * <li><i class="iconfont menu_icon icon-iconfont20"></i><span class="menu_title">喜剧片</span></li></a></ul>
       * </li>
       * 
       * 
       *<li><div class="sub_menu"><i class="iconfont menu_icon icon-iconfont1"></i><span class="menu_title">数据模型</span><i class="iconfont arrow_icon icon-jiantou"></i>
        </div><ul><a href="#" onclick="Detail('xiang_menu');">
        <li><i class="iconfont menu_icon icon-iconfont1"></i><span class="menu_title">xiang_menu</span></li></a><a href="#" onclick="Detail('xiang_user');">
          <li><i class="iconfont menu_icon icon-iconfont1"></i><span class="menu_title">xiang_user</span></li></a><a href="#" onclick="Detail('yao_demo_pet');">
            <li><i class="iconfont menu_icon icon-iconfont1"></i><span class="menu_title">yao_demo_pet</span></li></a></ul>
            </li>
       * 
       * */

      const yao = new Yao();

      $(document).ready(function () {
        var meunList = GetMenu();
      });
      async function GetMenu() {
        var resp = await yao.Get("/studio/menu");
        if (resp && resp.code) {
          var navMenuWrap = document.getElementById("nav_meun_wrap");
          var classList = navMenuWrap.className.split(" ");
          var meunList = resp.meunList;
          var re = [
            {
              path: "/index.html",
              title: "数据模型",
              value: "#",
              icon: "icon-iconfont1",
              children: meunList,
            },
          ];
          var menuDom = renderMenu(re);
          navMenuWrap.innerHTML = menuDom;
        }
      }

      function renderMenu(data) {
        if (data.length) {
          menuDom = "";
          menuDom += `<ul class="hide_collapse">`;
          for (var i = 0; i < data.length; i++) {
            if (data[i].children && data[i].children.length) {
              menuDom += `<li>`;
              menuDom += `<div class="sub_menu">`;
              menuDom += `<i class="iconfont menu_icon ${data[i].icon}"></i>`;
              menuDom += `<span class="menu_title">${data[i].title}</span>`;
              menuDom += `<i class="iconfont arrow_icon icon-jiantou"></i>`;
              menuDom += `</div>`;
              menuDom += renderMenu(data[i].children); // 有children结构的
              menuDom += `</li>`;
            } else {
              menuDom += `<a href="#" onclick="Detail('${data[i].value}');" >`;
              menuDom += `<li>`;
              menuDom += `<i class="iconfont menu_icon ${data[i].icon}"></i>`;
              menuDom += `<span class="menu_title">${data[i].title}</span>`;
              menuDom += `</li>`;
              menuDom += `</a>`;
            }
          }
          menuDom += `</ul>`;
          return menuDom;
        }
      }
      function Detail(value) {
        ModelDetail(value);
      }
      async function ModelDetail(value) {
        var resp = await yao.Get("/studio/detail?name=" + value);
        if (resp && resp.code == 200) {
          var table = "";
          table =
            table +
            `<table class="uk-table uk-table-striped">
        <thead>
          <tr>
            <th>字段名称</th>
            <th>字段类型</th>
            <th>中文名称</th>
            <th>备注</th>
            <th>是否为空</th>
          </tr>
        </thead>
        <tbody>`;
          for (var i in resp["data"]) {
            table =
              table +
              `  <tr>
            <td>${resp["data"][i]["name"] || ""}</td>
            <td>${resp["data"][i]["type"] || ""}</td>
            <td>${resp["data"][i]["label"] || ""}</td>
            <td>${resp["data"][i]["comment"] || ""}</td>
            <td>${resp["data"][i]["nullable"] || "false"}</td>

          </tr>`;
          }
          table =
            table +
            ` </tbody>
      </table>`;
          var table_div = document.getElementById("table_div");
          table_div.innerHTML = table;
        }
      }
    </script>

    <!-- <script src="./js/meunData.js"></script> -->
    <!-- 渲染菜单 -->
    <!-- <script src="./js/renderMeun.js"></script> -->
    <!-- 折叠菜单 -->
    <!-- <script src="./js/collapseMeun.js"></script> -->
    <!-- 折叠导航 -->
    <!-- <script src="./js/collapseNav.js"></script> -->
  </body>
</html>
